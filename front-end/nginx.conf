server {
    # Écoute le port 80 (le port standard pour le HTTP dans Docker)
    listen 80;
    server_name localhost;

    # Répertoire où Nginx trouve les fichiers compilés de votre application Angular
    # Ce chemin correspond à la ligne COPY dans le Dockerfile : COPY --from=build /app/dist /usr/share/nginx/html
    root /usr/share/nginx/html;
    index index.html;

    # Configuration essentielle pour Angular (Routage client/Deep Linking)
    # Si Nginx ne trouve pas de fichier correspondant à l'URL demandée, 
    # il renvoie index.html pour laisser le routeur Angular gérer la route.
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Configuration OPTIONNELLE : Proxy vers le backend (si le frontend et le backend sont sur le même domaine)
    # Si vous voulez que toutes les requêtes allant à /api soient redirigées vers votre service Spring Boot (port 9000)
    # Si vous utilisez cette configuration, vous n'avez pas besoin d'un proxy CORS complexe.
    # location /api {
    #     proxy_pass http://backend:9000; # 'backend' est le nom du service dans docker-compose.yml
    #     proxy_set_header Host $host;
    #     proxy_set_header X-Real-IP $remote_addr;
    # }
}